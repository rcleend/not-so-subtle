<template>
    <div>
        <svg id="loading-logo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
             viewBox="0 0 700 150" overflow="visible">
            <path id="right-blob"
                  data-animation-duration="3000"
                  data-animation-easing="easeInOutQuad"
                  data-animation-scale-x="1"
                  data-animation-scale-y="1.1"
                  data-animation-delay="300"
                  data-animation-rotate="-2"
                  data-animation-elasticity="300"
                  data-init-path=" M 398 60 C 400.313 60.383 404.188 61.875 404 66 C 403.563 69.562 398.313 70.688 395 70 C 390.063 68.563 389.055 67.58 384 67 C 379.368 66.267 376.313 68.438 372.525 68.386 C 368.938 68.313 367.833 66.875 367 65 C 366.813 63.938 366.313 58.438 370.899 57.429 C 374.688 57.188 381.563 63.312 387 61.382 C 389.688 60.313 392.667 59.571 398 60 Z "
                  data-morph-path=" M 483 34 C 520.974 20.236 601.094 14.621 653 58 C 674.55 79.472 666.282 107.037 635 125.39 C 575.152 156.982 512.142 136.362 452 108 C 405.836 85.378 359.606 73.995 304.395 79 C 238.142 86.465 203.857 125.498 191 103 C 165.474 50.433 195.686 11.823 257.898 21 C 296.625 29.341 356.687 66.513 403.248 54 C 418.305 50.15 466.545 39.338 483 34 Z "
                  d=" M 471.787 24.035 C 509.762 10.271 615.705 5.682 667.612 49.061 C 689.162 70.533 704.548 107.037 673.265 125.39 C 613.417 156.982 516.435 153.752 456.293 125.39 C 410.129 102.768 359.606 85.348 304.395 90.354 C 238.142 97.819 200.491 102.841 187.634 80.343 C 162.108 27.776 195.686 -3.912 257.898 5.265 C 296.625 13.606 356.687 56.568 403.248 44.055 C 418.305 40.205 455.333 29.373 471.787 24.035 Z "
                  fill="rgb(145,198,195)"/>
            <path id="left-blob"
                  data-animation-duration="3000"
                  data-animation-easing="easeInOutCubic"
                  data-animation-scale-x="1.05"
                  data-animation-scale-y="1"
                  data-animation-delay="0"
                  data-animation-rotate="-2"
                  data-animation-elasticity="300"
                  data-init-path=" M 357.922 66.929 C 355.375 68.25 351.75 68.625 350 66 C 348.875 64.375 348.501 62.342 350 60 C 351.5 57.875 353.557 56.586 357.922 58.71 C 361.293 60.429 364.81 59.992 368.094 58.71 C 372.001 57.02 375.684 55.978 377 58.143 C 379.797 63.265 376.986 67.027 372.941 66.929 C 370.361 66.594 367.576 61.055 365 63 C 364.162 63.608 358.811 66.146 357.922 66.929 Z "
                  data-morph-path=" M 198 122 C 169.985 133.228 100.395 150.821 62.1 115.437 C 46.203 97.922 30.332 76.971 53.409 62 C 97.563 36.231 165.629 30.865 210 54 C 244.058 72.453 289.268 89.446 330 85.363 C 378.878 79.274 393.763 67.011 403.248 85.363 C 422.08 128.242 396.896 147.484 351 140 C 322.43 133.195 286.963 92.793 252.613 103 C 241.505 106.141 210.14 117.645 198 122 Z "
                  d=" M 202.048 131.294 C 174.033 142.522 95.875 146.264 57.58 110.88 C 41.682 93.365 30.332 63.589 53.409 48.619 C 97.563 22.85 169.109 25.484 213.48 48.619 C 247.537 67.072 284.809 81.28 325.541 77.197 C 374.419 71.109 402.195 67.011 411.68 85.363 C 430.512 128.242 405.74 154.089 359.844 146.605 C 331.274 139.8 286.963 104.756 252.613 114.963 C 241.505 118.104 214.188 126.939 202.048 131.294 Z "
                  fill="rgb(208,234,232)"/>

            <g id="loading-logo-text">
                <path d=" M 49.375 48.051 C 64.139 35.549 75.361 60.451 74.828 74.717 C 74.222 102.745 60.325 113.136 45.739 100.17 C 40.991 96.064 38.075 92.506 37.254 86.837 C 41.556 105.892 26.189 111.773 14.225 100.17 C 3.165 84.11 7.905 56.615 19.074 48.051 C 28.77 41.688 39.286 49.073 45.739 67.445 C 45.188 60.18 44.578 52.908 49.375 48.051 Z "
                      fill="none" stroke-width="5" stroke="rgb(0,0,0)"/>
                <path d=" M 101.911 44.528 C 88.51 46.317 81.74 55.923 81.565 73.308 C 82.014 92.758 90.06 103.199 105.665 104.591 C 125.851 105.04 137.162 97.134 135.695 77.062 C 134.042 54.344 120.281 42.952 101.911 44.528 Z "
                      fill="none" stroke-width="5" stroke="rgb(0,0,0)"/>
                <path d=" M 153.016 44.646 C 157.786 43.783 172.098 44.331 188.052 44.646 C 201.973 45.269 208.698 65.916 188.052 68.575 C 180.857 69.67 180.973 72.132 184.298 81.088 C 189.303 93.913 182.8 103.531 171.785 103.611 C 158.803 102.829 155.531 95.907 160.524 81.088 C 163.183 72.798 159.349 68.715 151.764 69.826 C 134.403 70.139 136.28 48.397 153.016 44.646 Z "
                      fill="rgb(145,198,195)" stroke-width="5" stroke="rgb(0,0,0)"/>
                <path d=" M 273.338 59.333 C 273.504 50.54 267.394 44.786 257.285 44.317 C 250.073 44.122 246.319 45.881 241.061 49.322 C 238.106 51.552 235.416 53.926 234.548 59.333 C 234.196 66.479 236.711 71.913 242.056 75.599 C 247.054 79.017 243.162 83.37 239.553 81.856 C 231.224 79.51 226.738 81.093 224.537 86.861 C 222.498 93.686 223.357 98.716 229.543 101.877 C 234.04 104.34 240.129 105.026 245.037 104.379 C 256.638 103.144 264.987 97.253 265.83 91.866 C 267.912 85.013 263.497 77.101 255.82 73.097 C 251.719 71.617 253.654 67.066 257.285 68.092 C 259.371 68.308 261.364 69.396 262.076 69.343 C 269.03 69.016 272.797 65.692 273.338 59.333 Z "
                      fill="none" stroke-width="5" stroke="rgb(0,0,0)"/>
                <path d=" M 299.615 44.317 C 286.214 46.105 279.444 55.711 279.269 73.097 C 279.718 92.547 287.764 102.988 303.369 104.379 C 323.555 104.828 334.867 96.924 333.4 76.851 C 331.747 54.133 317.986 42.74 299.615 44.317 Z "
                      fill="none" stroke-width="5" stroke="rgb(0,0,0)"/>
                <path d=" M 358.145 89.832 C 357.979 98.625 364.088 104.378 374.199 104.847 C 381.411 105.042 385.165 103.283 390.422 99.842 C 393.376 97.614 396.066 95.239 396.935 89.832 C 397.286 82.686 394.771 77.251 389.427 73.565 C 384.428 70.148 388.322 65.796 391.93 67.308 C 400.258 69.655 404.745 68.072 406.945 62.303 C 408.985 55.48 408.126 50.45 401.94 47.288 C 397.443 44.824 391.354 44.139 386.445 44.785 C 374.846 46.02 366.496 51.911 365.652 57.298 C 363.572 64.151 367.987 72.063 375.663 76.067 C 379.765 77.548 377.83 82.1 374.199 81.073 C 372.112 80.856 370.118 79.769 369.406 79.821 C 362.453 80.148 358.686 83.473 358.145 89.832 Z "
                      fill="none" stroke-width="5" stroke="rgb(0,0,0)"/>
                <path d=" M 416.848 51.056 C 419.715 42.403 432.853 41.956 435.617 52.308 C 436.339 56.257 435.754 62.61 434.366 67.323 C 431.282 84.531 448.119 82.504 445.628 67.323 C 443.849 61.221 441.83 56.598 443.125 52.308 C 447.671 42 458.934 41.381 460.643 52.308 C 463.1 66.122 465.914 80.744 460.643 93.601 C 457.488 99.429 449.992 102.361 438.12 102.36 C 420.698 102.109 414.252 94.438 414.345 73.58 C 414.325 65.743 414.977 58.669 416.848 51.056 Z "
                      fill="none" stroke-width="5" stroke="rgb(0,0,0)"/>
                <path d=" M 471.706 59.672 C 470.298 68.587 470.66 78.978 471.706 92.205 C 471.704 100.28 478.806 103.63 492.978 102.216 C 508.315 102.878 518.395 93.613 518.004 82.195 C 517.691 74.062 508.906 66.718 501.737 69.682 C 511.122 54.51 497.827 41.841 486.722 43.405 C 478.406 45.043 473.413 50.478 471.706 59.672 Z "
                      fill="rgb(208,234,232)" stroke-width="5" stroke="rgb(0,0,0)" stroke-miterlimit="3"/>
                <path d=" M 527.246 41.363 C 510.434 43.698 509.034 63.623 519.775 67.657 C 522.118 68.428 524 67.89 526.001 67.657 C 534.556 66.748 537.77 71.201 533.473 82.459 C 530.052 92.902 534.489 101.916 544.681 102.527 C 556.678 102.719 564.679 90.953 559.625 78.852 C 555.803 69.975 556.939 65.823 564.606 66.399 C 578.233 67.581 583.55 43.078 564.606 41.363 C 551.946 40.532 539.505 40.544 527.246 41.363 Z "
                      fill="none" stroke-width="5" stroke="rgb(0,0,0)"/>
                <path d=" M 597.766 40.902 C 589.515 41.112 584.637 45.537 583.059 61.735 C 582.325 69.587 582.325 78.771 583.059 85.02 C 584.658 95.733 593.25 101.583 608.796 102.53 C 628.501 101.559 636.683 93.8 633.305 79.214 C 630.922 71.635 617.982 70.094 611.246 73.99 C 608.564 75.418 608.963 70.976 610.021 65.553 C 612.152 49.061 608.08 40.855 597.766 40.902 Z "
                      fill="none" stroke-width="5" stroke="rgb(0,0,0)"/>
                <path d=" M 661.383 37.783 C 645.332 37.938 640.211 47.836 640.668 73.246 C 640.058 89.929 646.913 100.995 663.82 102.505 C 683.164 103.431 688.039 78.147 676.007 78.441 C 673.265 78.604 671.691 79.229 669.913 79.34 C 665.496 79.823 664.43 77.232 668.694 74.48 C 674.483 70.226 673.721 63.981 668.694 62.974 C 661.535 62.153 661.23 57.127 668.694 56.348 C 678.442 55.3 675.396 37.326 661.383 37.783 Z "
                      fill="none" stroke-width="5" stroke="rgb(0,0,0)"/>
            </g>

        </svg>
    </div>
</template>

<script lang="ts">
    import {Component, Emit, Prop, Vue, Watch} from 'vue-property-decorator';
    import AnimatedBlob from '@/animations/AnimatedBlob';
    import AnimatedText from '@/animations/AnimatedText';

    @Component
    export default class Loader extends Vue {
        @Prop(Boolean) public readonly isLoading: boolean | undefined;

        private leftBlob: any;
        private rightBlob: any;
        private loadingText: any;

        private mounted(): void {
            this.leftBlob = new AnimatedBlob(document.getElementById('left-blob'));
            this.rightBlob = new AnimatedBlob(document.getElementById('right-blob'));
            this.loadingText = new AnimatedText(document.getElementById('loading-logo-text'));

            this.loadStart();
        }

        @Emit()
        private loaded(): boolean {
            return true;
        }

        @Watch('isLoading')
        private onLoadingChange(): void {
            this.isLoading ? this.loadStart() : this.loadFinished();
        }

        private loadStart(): void {
            this.loadingText.show();
            this.leftBlob.start();
            this.rightBlob.start();
        }

        private loadFinished(): void {
            this.loadingText.hide(this.loaded());
            this.leftBlob.end();
            this.rightBlob.end();
        }
    }


</script>

<style scoped lang="scss">
    div:first-child {
        position: absolute;
        display: flex;
        align-items: center;

        top: 0;
        bottom: 0;
        left: 0;
        right: 0;

        #loading-logo {
            margin: auto;
            width: 700px;
            height: auto;
        }

        #loading-logo-text path {
            opacity: 0;
        }
    }
</style>
